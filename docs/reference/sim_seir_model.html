<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-GB"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>SEIR model with time-varying transmission parameter — sim_seir_model • ggoutbreak</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="SEIR model with time-varying transmission parameter — sim_seir_model"><meta name="description" content="This function simulates an SEIR (Susceptible-Exposed-Infectious-Recovered) model
where the transmission rate (beta) varies over time."><meta property="og:description" content="This function simulates an SEIR (Susceptible-Exposed-Infectious-Recovered) model
where the transmission rate (beta) varies over time."><meta property="og:image" content="https://ai4ci.github.io/ggoutbreak/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ggoutbreak</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.4.8</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/ggoutbreak.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/covid-timeseries.html">England COVID-19 cases</a></li>
    <li><a class="dropdown-item" href="../articles/estimators-example.html">Simulation tests for growth rate estimators</a></li>
    <li><a class="dropdown-item" href="../articles/incidence-trends.html">Population comparisons and incidence</a></li>
    <li><a class="dropdown-item" href="../articles/infectivity-profile-discretisation.html">Infectivity profile discretisation</a></li>
    <li><a class="dropdown-item" href="../articles/rt-from-incidence.html">Estimating the reproduction number from modelled incidence</a></li>
    <li><a class="dropdown-item" href="../articles/sampling-serial-interval.html">Sampling the infectivity profile from published serial interval estimates</a></li>
    <li><a class="dropdown-item" href="../articles/simulation-test-models.html">Simulations and test harnesses</a></li>
    <li><a class="dropdown-item" href="../articles/time-periods.html">Data wrangling and working with `ggoutbreak`</a></li>
    <li><a class="dropdown-item" href="../articles/variant-proportions.html">Multinomial proportions models for genomic variants</a></li>
    <li><a class="dropdown-item" href="../articles/weekly-incidence.html">Estimating the reproduction number from weekly data</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ai4ci/ggoutbreak/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>SEIR model with time-varying transmission parameter</h1>
      <small class="dont-index">Source: <a href="https://github.com/ai4ci/ggoutbreak/blob/HEAD/R/simulation-utils.R" class="external-link"><code>R/simulation-utils.R</code></a></small>
      <div class="d-none name"><code>sim_seir_model.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function simulates an SEIR (Susceptible-Exposed-Infectious-Recovered) model
where the transmission rate (<code>beta</code>) varies over time.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">sim_seir_model</span><span class="op">(</span></span>
<span>  changes <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>t <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">30</span><span class="op">)</span>, dBeta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="va">mean_latent_period</span>,</span>
<span>  <span class="va">mean_gen_time</span>,</span>
<span>  R0 <span class="op">=</span> <span class="fl">2.5</span>,</span>
<span>  fn_dBeta <span class="op">=</span> <span class="fu"><a href="cfg_step_fn.html">cfg_step_fn</a></span><span class="op">(</span><span class="va">changes</span><span class="op">)</span>,</span>
<span>  N <span class="op">=</span> <span class="fl">10000</span>,</span>
<span>  imports <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  max_time <span class="op">=</span> <span class="fl">104</span>,</span>
<span>  seed <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-changes">changes<a class="anchor" aria-label="anchor" href="#arg-changes"></a></dt>
<dd><p>a dataframe holding change time points (<code>t</code>) and
the proportional increase in the transmission rate in the <code>dBeta</code> column</p></dd>


<dt id="arg-mean-latent-period">mean_latent_period<a class="anchor" aria-label="anchor" href="#arg-mean-latent-period"></a></dt>
<dd><p>Mean time from infection to becoming infectious (E to I),
assumed to be exponentially distributed.</p></dd>


<dt id="arg-mean-gen-time">mean_gen_time<a class="anchor" aria-label="anchor" href="#arg-mean-gen-time"></a></dt>
<dd><p>The average generation time (will be latent period+infectious duration).</p></dd>


<dt id="arg-r-">R0<a class="anchor" aria-label="anchor" href="#arg-r-"></a></dt>
<dd><p>the initial reproduction number</p></dd>


<dt id="arg-fn-dbeta">fn_dBeta<a class="anchor" aria-label="anchor" href="#arg-fn-dbeta"></a></dt>
<dd><p>A function of time <code>t</code> that returns the multiple of
transmission rate at that time point. Transmission (beta) at time zero is
defined by R0 and the infectious duration, This is multiplied at each time
by this factor.</p></dd>


<dt id="arg-n">N<a class="anchor" aria-label="anchor" href="#arg-n"></a></dt>
<dd><p>Total population size. Defaults to 10,000.</p></dd>


<dt id="arg-imports">imports<a class="anchor" aria-label="anchor" href="#arg-imports"></a></dt>
<dd><p>Initial number of infectious individuals. Defaults to 10.</p></dd>


<dt id="arg-max-time">max_time<a class="anchor" aria-label="anchor" href="#arg-max-time"></a></dt>
<dd><p>Maximum simulation time (in days or time units). Defaults to 100.</p></dd>


<dt id="arg-seed">seed<a class="anchor" aria-label="anchor" href="#arg-seed"></a></dt>
<dd><p>a random seed</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A dataframe containing the following columns:</p><ul><li><p>statistic (character) - An identifier for the statistic, whether that be infections, admissions, deaths</p></li>
<li><p>count (positive_integer) - Positive case counts associated with the specified time frame</p></li>
<li><p>time (ggoutbreak::time_period + group_unique) - A (usually complete) set of singular observations per unit time as a <code>time_period</code></p></li>
</ul><p>Minimally grouped by: statistic (and other groupings allowed).</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The latent period (time from infection to becoming infectious) is assumed to be
exponentially distributed. The infectious period is derived from the given
mean of the generation time and the latent period.</p>
<p>The model assumes:</p><ul><li><p>Latent period ~ Exponential(sigma), where sigma = 1 / <code>mean_latent_period</code></p></li>
<li><p>Infectious period ~ Exponential(gamma), where gamma = 1 / (mean_gen_time - mean_latent_period)</p></li>
<li><p>Generation time ~ Exponential(sigma) + Exponential(gamma)</p></li>
<li><p>beta0 = R0 * gamma</p></li>
<li><p>Transmission rate beta(t) = fn_dBeta(t) * beta0</p></li>
</ul><p>The generation time is defined as the sum of the latent and infectious periods.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Example: Lockdown after day 30</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">seir_output</span> <span class="op">&lt;-</span> <span class="fu">sim_seir_model</span><span class="op">(</span></span></span>
<span class="r-in"><span>  mean_latent_period <span class="op">=</span> <span class="fl">4</span>,</span></span>
<span class="r-in"><span>  mean_gen_time <span class="op">=</span> <span class="fl">7</span>,</span></span>
<span class="r-in"><span>  R0 <span class="op">=</span> <span class="fl">2.5</span>,</span></span>
<span class="r-in"><span>  fn_dBeta <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">t</span> <span class="op">&lt;</span> <span class="fl">30</span>, <span class="fl">1</span>, <span class="fl">0.5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="plot_ip.html">plot_ip</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">seir_output</span>,<span class="st">"ip"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="plot_counts.html">plot_counts</a></span><span class="op">(</span><span class="va">seir_output</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Robert Challen.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

