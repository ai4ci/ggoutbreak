% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/utils-vcov.R
\name{vcov_from_residuals}
\alias{vcov_from_residuals}
\title{Estimate Parametric VCOV Matrix from Residuals}
\usage{
vcov_from_residuals(
  data,
  mu,
  sigma,
  max_lag = 10,
  min_alpha = 0.01,
  max_alpha = 2
)
}
\arguments{
\item{data}{Numeric vector: observed case counts I_t}

\item{mu}{Numeric vector: estimated log-incidence (log lambda_t)}

\item{sigma}{Numeric vector: estimated standard error of log lambda_t}

\item{max_lag}{Integer: maximum lag for ACF estimation (default: 10)}

\item{min_alpha}{Positive number: minimum decay rate (default: 0.01)}

\item{max_alpha}{Positive number: maximum decay rate (default: 2.0)}
}
\value{
List with:
\itemize{
\item vcov_matrix: T x T estimated VCOV matrix for log lambda_t
\item alpha: fitted decay parameter
\item acf_obs: observed ACF of Pearson residuals
\item acf_fit: fitted ACF values
\item residuals: Pearson residuals used
\item times: time indices
}
}
\description{
Estimates the variance-covariance matrix of log-incidence estimates
by modelling residual autocorrelation with an exponential decay model.
}
\details{
This function was generated by Qwen3-235B-A22B-2507
}
\examples{
T <- 50
mu <- 5 + 0.05 * (1:T) + stats::arima.sim(list(ar = 0.8), n = T, sd = 0.3)
sigma <- rep(0.2, T)
lambda <- exp(mu)
data <- stats::rpois(T, lambda)

result <- vcov_from_residuals(data, mu, sigma, max_lag = 8)
dim(result$vcov_matrix)  # Should be T x T

}
